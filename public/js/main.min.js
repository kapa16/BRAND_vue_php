$(document).ready(()=>{const t=$(".main-logo-menu");t.fadeOut().mouseleave(()=>t.fadeOut()),$(".header").mousemove(()=>t.fadeIn());const e=$(".logo-menu-list .dropdown-box");e.fadeOut().mouseleave(()=>e.fadeOut()),$(".logo-menu-list").mouseenter(t=>{$(t.target).siblings(".dropdown-box").fadeIn().mouseleave(()=>e.fadeOut())}).mouseleave(()=>e.fadeOut());const a=$(".browse .dropdown-box");a.fadeOut().mouseleave(()=>{a.fadeOut()}),$(".browse").mousemove(()=>a.fadeIn()).mouseleave(()=>a.fadeOut())});class Cart{constructor(t,e=".cart__container"){this.source=t,this.container=e,this.countGoods=0,this.amount=0,this.cartItems=[],this._init()}_init(){this._render(),this._addEventHandlers(),fetch(this.source).then(t=>t.json()).then(t=>{for(let e of t.contents)this.cartItems.push(e),this._renderItem(e);this.countGoods=t.countGoods,this.amount=t.amount,this._renderSum()})}_render(){let t=$("<div/>",{class:"cart__menu hidden"}),e=$("<div/>",{class:"cart-total"});e.append("<p>TOTAL</p>"),e.append('<p class="cart-total-sum">$0.00</p>');const a=$("<div/>",{class:"cart__menu-buttons"}),n=$("<a/>",{href:"checkout.html",class:"cart__menu-button",text:"Checkout"}),r=$("<a/>",{href:"shopping-cart.html",class:"cart__menu-button",text:"Go to cart"});a.append(n).append(r),t.append('<div class="cart-items-wrap"></div>').append(e).append(a).appendTo($(this.container))}_addEventHandlers(){const t=$(".cart__menu");$(this.container).mousemove(()=>t.fadeIn()).mouseleave(()=>t.delay(500).fadeOut()),t.mousemove(()=>t.stop()).mouseleave(()=>{t.fadeOut()})}_getMainItemContainer(t,e){return $("<div/>",{class:t,"data-product":e})}_getImageElement(t){return $("<img/>",{src:t.img_src,alt:t.img_alt})}_getProductRatingElement(){const t=$('<div class="product-rating"></div>');for(let e=0;e<5;e++)t.append('<i class="fas fa-star rating-star"></i>');return t}_getDivElement(t,e=""){return $(`<div class="${t}">${e}</div>`)}_getParagraphElement(t,e){return $(`<p class="${t}">${e}</p>`)}_getSpanElement(t,e){return $(`<span class="${t}">${e}</span>`)}_renderItem(t){this._renderItemMenuCart(t),this._renderItemPageCart(t)}_renderItemMenuCart(t){const e=this._getMainItemContainer("cart__card cart-item-wrapper",t.id_product),a=this._getImageElement(t);a.addClass("photo-product");const n=this._getDivElement("product-info");n.append(this._getParagraphElement("product-name for-cart-menu",t.product_name)).append(this._getProductRatingElement().addClass("for-cart-menu")).append(this._getDivElement("cart__product-total").append(this._getSpanElement("product-quantity",t.quantity)).append("<span> x </span>").append(this._getSpanElement("product-price",`&#36;${t.price}`))),e.append(a).append(n).append(this._getDivElement("fas fa-times-circle delete-product").click(t=>this._onChangeQuantity(t.target,!0))).appendTo($(".cart-items-wrap"))}_renderItemPageCart(t){const e=this._getMainItemContainer("cart-table-row cart-item-wrapper",t.id_product),a=this._getDivElement("product-details cart-table-cell"),n=this._getImageElement(t),r=this._getDivElement("product-details-description");r.append(this._getParagraphElement("product-name",t.product_name)).append(this._getProductRatingElement()).append(this._getParagraphElement("product-details-properties","Color: ").append(this._getSpanElement("product-details-value",t.color))).append(this._getParagraphElement("product-details-properties","Size: ").append(this._getSpanElement("product-details-value",t.size))),a.append(n).append(r),e.append(a).append(this._getDivElement("cart-table-cell",`&#36;${t.price}`)).append(this._getDivElement("cart-table-cell").append($('<input class="cart-table-quantity" value="2" type="number" name="quantity">').val(t.quantity).change(t=>this._onChangeQuantity(t.target)))).append(this._getDivElement("cart-table-cell",t.shipping)).append(this._getDivElement("cart-table-cell  product-price",`&#36;${t.quantity*t.price}`)).append(this._getDivElement("cart-table-cell").append(this._getDivElement("fas fa-times-circle cart-table-close-icon delete-product")).click(t=>this._onChangeQuantity(t.target,!0))).appendTo($(".cart-table"))}_renderSum(){$(".cart__quantity").text(this.countGoods),$(".cart-total-sum").text(`$${this.amount}`)}_updateCart(t){let e=$(`div[data-product="${t.id_product}"]`);e.find(".product-quantity").text(t.quantity),e.find(".product-price").text(`$${t.quantity*t.price}`)}_getCartItem(t){return this.cartItems.find(e=>e.id_product===t)}addProduct(t){t.preventDefault();const e=$(t.target).closest("[data-id]"),a=e.find("img")[0],n=e.find("#quantity")[0];let r=1;n&&(r=+n.value,n.value=1);let s=+e.data("id"),i=this._getCartItem(s);if(i)this._changeQuantity(i,i.quantity+r),this._showMessage(`Количество товара ${i.product_name} увеличено`);else{let t={id_product:s,product_name:e.data("name"),price:e.data("price"),quantity:r,img_src:a.src,img_alt:a.alt,color:e.data("color"),size:e.data("size")};this.cartItems.push(t),this._renderItem(t),this.amount+=t.price,this.countGoods+=t.quantity,this._showMessage(`Товар ${t.product_name} успешно добавлен в корзину`)}this._renderSum()}_showMessage(t){$(".cart__add-message").text(t).fadeIn("slow").delay(3e3).fadeOut("slow")}_getItemWrapper(t){return $(t).closest(".cart-item-wrapper")}_getEventProductId(t){return this._getItemWrapper(t).data("product")}_onChangeQuantity(t,e=!1){let a=this._getCartItem(this._getEventProductId(t)),n=0;const r=this._getItemWrapper(t).find(".cart-table-quantity");r.length&&(n=+r[0].value),this._changeQuantity(a,e?0:n)}_changeQuantity(t,e){this.countGoods-=t.quantity,this.amount-=t.price*t.quantity,0===e?this._remove(t.id_product):(t.quantity=e,this.countGoods+=e,this.amount+=t.price*e,this._updateCart(t)),this._renderSum()}_remove(t){let e=this._getCartItem(t);this.cartItems.splice(this.cartItems.indexOf(e),1),$(`div[data-product="${t}"]`).remove()}clearCart(t){for(t.preventDefault();this.cartItems.length;)this._changeQuantity(this.cartItems[this.cartItems.length-1],0)}}class Accordion{constructor(t){this.containerClass=t,this._init()}_init(){$(this.containerClass).find(".sidebar-title").click(t=>this._toggleMenu(t))}_toggleMenu(t){$(".menu-open").removeClass("menu-open");const e=$(t.target).closest(".sidebar-title"),a=e.next();$(this.containerClass).find(".sidebar-submenu").not(a[0]).slideUp(),a.slideToggle("fast",()=>{a.is(":visible")&&e.closest("li").addClass("menu-open")})}}$(document).ready(()=>{$(window).scroll(()=>{$(this).scrollTop()>40?$(".header").height(60):0===$(this).scrollTop()?$(".header").height(100):$(".header").height(100-$(this).scrollTop())});let t=new Cart("json/getCart.json");$(".add-cart-wrap").click(e=>{t.addProduct(e)}),$(".clear-cart-btn").click(e=>{t.clearCart(e)});new Accordion(".sidebar");$(".slider-control-wrap").on("click",t=>{$(".slider-control-wrap .slider-control").removeClass("active"),$(t.target).addClass("active")})});